# Lab 8: AI Services Chat Application

**COMP305 Fall 2025 Lab 8 Assignment**  
**Author:** Eden Tripp  
**Deployed URL:** https://comp305lab8-et.netlify.app/

A chat application demonstrating the Service Layer pattern with multiple AI providers. Users can switch between local pattern-matching (Eliza) and cloud-based AI services (Gemini, Groq) through a unified interface.

---

## Project Overview

This project implements a modular architecture that allows seamless integration of multiple AI providers without rewriting core application logic. The Service Layer pattern ensures loose coupling between the UI and AI implementations.

### Features

- Multiple AI providers (Eliza, Gemini, Groq)
- Runtime provider switching
- Persistent chat history using localStorage
- Comprehensive E2E testing with Playwright
- Secure API key management

---
## Setup Instructions (For Development)

If you want to run this project locally or run tests:

1. Clone the repository:
```bash
   git clone https://github.com/eden-elise/lab8-ai-services.git
   cd lab8-ai-services
```

2. Install dependencies:
```bash
   npm install
```

3. Install Playwright browsers:
```bash
   npx playwright install
```

4. Run locally:
```bash
   npx http-server src -p 8080
```
Open http://localhost:8080

5. Run tests:
```bash
   npm test
```

---

## Architecture

### Service Layer Pattern
```
Controller
    ↓
ServiceSelector (Factory)
    ↓
┌─────────┬──────────────┬─────────────┐
│  Eliza  │   Gemini     │    Groq     │
│ Service │   Service    │   Service   │
└─────────┴──────────────┴─────────────┘
```

This architecture provides:
- Easy addition of new AI providers
- Testable components through mocking
- Separation of concerns
- Single Responsibility Principle compliance

### Project Structure
# Project Structure

```text
lab8-ai-services/
├─ .idea/
├─ node_modules/                # deps (autogenerated)
├─ playwright-report/           # Playwright test reports
├─ r-n-d/                       # scratch + experiments
│  ├─ gemini-test/
│  │  └─ test-gemini.html
│  ├─ groq-test/
│  │  └─ test-groq.html
│  └─ compare.md
├─ src/
│  ├─ js/
│  │  ├─ app.js                 # entry / bootstrap
│  │  ├─ controller.js
│  │  ├─ eliza.js               # ELIZA rules/logic
│  │  ├─ model.js
│  │  └─ view.js
│  ├─ services/
│  │  ├─ AIService.js           # base service interface
│  │  ├─ ElizaService.js
│  │  ├─ GeminiService.js
│  │  ├─ GroqService.js
│  │  └─ ServiceSelector.js     # choose active backend
│  ├─ index.html
│  └─ styles.css
├─ test-results/                # test outputs/artifacts
├─ tests/
│  ├─ ai-services.spec.js
│  └─ eliza.spec.js
├─ .gitignore
├─ LICENSE
├─ package.json
└─ package-lock.json
```

---

## Design Decisions and Trade-offs

### Client-Side API Calls

**Implementation:**
- Browser directly calls AI provider APIs
- API keys stored in browser memory

**Advantages:**
- Simple implementation without backend infrastructure
- Fast response times (direct communication)
- Appropriate for learning and demonstration purposes

**Disadvantages:**
- API keys visible in browser developer tools
- Cannot enforce rate limiting server-side
- No centralized usage monitoring
- Not suitable for production deployment

### Async/Await Pattern

Chose async/await over Promises or callbacks for:
- Improved code readability
- Simplified error handling with try-catch
- Modern JavaScript standard compliance

### Error Handling

Implemented:
- Try-catch blocks for network and runtime errors
- Provider-specific error checking
- Automatic fallback to Eliza on failure
- User-friendly error messages

---

## AI Service Comparison

Full research documentation and more information available at: [r-n-d/comparison.md](r-n-d/compare.md)

### Provider Overview

| Feature | Eliza | Gemini | Groq |
|---------|-------|--------|------|
| Speed | Instant | 2-5 seconds | 0.5-2 seconds |
| Quality | Pattern matching | Advanced AI | Advanced AI |
| Cost | Free | Free tier available | Free |
| Privacy | 100% local | Cloud-based | Cloud-based |
| Setup | None | API key required | API key required |

### Eliza (Local)

**Advantages:**
- Completely local processing (maximum privacy)
- Zero cost
- No network dependency
- No rate limits

**Disadvantages:**
- Limited to pattern matching
- Cannot handle complex queries
- No learning capability

**Best for:** Privacy-critical applications, offline use, demonstrations

### Google Gemini

**Advantages:**
- Advanced language understanding
- Multimodal support (text, images, video)
- Integration with Google Cloud ecosystem
- Access to latest model updates

**Disadvantages:**
- Requires API key
- Data sent to Google servers
- May have costs beyond free tier
- Subject to Google's privacy policies

**Best for:** Production applications requiring advanced AI capabilities

**API Key:** https://ai.google.dev/  
**Free Tier:** 15 requests/minute, 1 million tokens/day

### Groq

**Advantages:**
- Extremely fast inference
- OpenAI-compatible API
- Generous free tier
- Based on open-source models (Llama)

**Disadvantages:**
- Requires API key
- Data sent to Groq servers
- Text-only (no multimodal support)

**Best for:** Speed-critical applications, cost-conscious deployments

**API Key:** https://console.groq.com/  
**Free Tier:** 30 requests/minute, 6,000 tokens/minute

---

## Privacy and Cost Discussion

### Privacy Considerations

**Eliza (Local Processing):**
- All data remains in the browser
- No network requests
- Complete user privacy
- Suitable for sensitive information

**Cloud AI Providers (Gemini, Groq):**
- User messages transmitted to provider servers
- Subject to provider privacy policies
- Data may be used for model improvement
- Not recommended for sensitive or confidential information

### Cost Analysis

**Eliza:**
- Cost: $0
- No limits or restrictions

**Gemini:**
- Free Tier: 1 million tokens per day
- Paid Tier: ~$0.35-$1.05 per million tokens
- Typical usage for this application: <1,000 tokens/day (well within free tier)

**Groq:**
- Currently free for standard usage
- Very generous rate limits
- No credit card required


### Security Implementation

**API Key Management:**
- Keys prompted from user at runtime
- Stored only in browser memory (not persisted)
- Never committed to version control
- `.gitignore` configured to prevent accidental commits

**Limitations:**
- Keys visible in browser developer tools
- Keys lost when browser tab closes
- Not suitable for production deployment

**Production Requirements:**
- Backend server to proxy API requests
- Environment variables for key storage
- Proper authentication and authorization
- Key rotation policies

---

## Testing

### Test Suite

12 Playwright E2E tests covering:

**Eliza Tests (7 tests):**
- UI component loading
- Default provider selection
- Message sending and receiving
- Multi-turn conversations
- Pattern matching validation
- Message clearing
- localStorage persistence

**AI Services Tests (5 tests):**
- Provider switching
- API key validation
- Mocked Gemini responses
- Mocked Groq responses
- Error handling

### Why Mock APIs?

Tests use mocked API responses to:
- Avoid consuming API quota during development
- Ensure fast test execution
- Provide deterministic results
- Enable offline testing
- Prevent test failures due to API downtime

---

## Technical Stack

- Vanilla JavaScript (ES6 modules)
- Model-View-Controller (MVC) architecture
- Service Layer pattern
- Fetch API for HTTP requests
- localStorage for persistence
- Playwright for E2E testing
- CSS custom properties for theming

---

## Browser Compatibility

- Chrome/Edge: Supported
- Firefox: Supported
- Safari: Supported

Requires ES6 module support, Fetch API, and localStorage.

---

## Known Limitations

1. API keys must be re-entered each session
2. Chat history limited to single browser/device
3. No user authentication
4. No message encryption at rest
5. Limited to text-based interactions
6. No conversation context management across provider switches

---

## License

MIT License

---

## Repository

GitHub: https://github.com/[eden-elise]/lab8-ai-services

---

**COMP305 Fall 2025**